<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì…í•™ì„¤ëª…íšŒ ì‹ ì²­ í™•ì¸</title>
    </head>
<body>
    <div class="container">
        <button onclick="checkSubmission()">ì‹ ì²­ í™•ì¸</button>
        <div id="result" class="result"></div>
    </div>

    <script>
        // --- ì—¬ê¸°ë¶€í„° ì•„ë˜ê¹Œì§€, ìœ„ì— ë³´ì—¬ì£¼ì‹  JavaScript ì½”ë“œê°€ ì •í™•íˆ ë“¤ì–´ê°€ì•¼ í•©ë‹ˆë‹¤. ---
        async function checkSubmission() {
            const name = document.getElementById("name").value.trim();
            const phone = document.getElementById("phone").value.trim();
            const resultDiv = document.getElementById("result");
            const checkButton = document.querySelector('button');

            resultDiv.style.display = "none";
            resultDiv.className = "result";
            resultDiv.innerText = "";
            checkButton.disabled = false;

            if (!name || !phone) {
                resultDiv.style.display = "block";
                resultDiv.className = "result error";
                resultDiv.innerText = "ì´ë¦„ê³¼ ì—°ë½ì²˜ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                return;
            }

            resultDiv.style.display = "block";
            resultDiv.className = "result loading";
            resultDiv.innerText = "ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”...";
            checkButton.disabled = true;

            try {
                const appsScriptUrl = `https://script.google.com/macros/s/AKfycbzN9Uh01HzhmstcnzVcwLI7STnP4Ya17V4kes4K_n3jWfAH6oW2F8doGr_07yaDe7yd/exec`;
                const response = await fetch(`${appsScriptUrl}?name=${encodeURIComponent(name)}&phone=${encodeURIComponent(phone)}`);
                const data = await response.json();

                checkButton.disabled = false;

                if (data.error) {
                    resultDiv.className = "result error";
                    resultDiv.innerText = data.error;
                } else {
                    resultDiv.className = "result";
                    let rankMessage = '';
                    if (data.rank) {
                        rankMessage = `\n\nğŸ“¢ ${data.major} ì‹ ì²­ì ì¤‘ ${data.rank}ë²ˆì§¸ì…ë‹ˆë‹¤.`;
                    }

                    let attendeesInfo = '';
                    if (data.attendees !== undefined && data.attendees !== null && data.attendees !== '') {
                        attendeesInfo = `ì°¸ì„ ì¸ì›: ${data.attendees}\n`;
                    }

                    let otherInfoLine = '';
                    if (data.otherInfo !== undefined && data.otherInfo !== null && data.otherInfo !== '') {
                        otherInfoLine = `ê·¸ ì™¸ ì°¸ê°€ì ì •ë³´: ${data.otherInfo}\n`;
                    }

                    resultDiv.innerText =
                        `âœ… ì‹ ì²­ ë‚´ì—­ í™•ì¸\n\n` +
                        `ì´ë¦„: ${data.name}\n` +
                        `ì „ê³µ ì„ íƒ: ${data.major}\n` +
                        attendeesInfo +
                        otherInfoLine +
                        `ì‹ ì²­ ì‹œê°„: ${data.timestamp}` +
                        rankMessage;
                }
            } catch (err) {
                console.error("Fetch error:", err);
                checkButton.disabled = false;
                resultDiv.className = "result error";
                resultDiv.innerText = "ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
            }
        }
        // --- ì—¬ê¸° ìœ„ì—ê¹Œì§€ê°€ í•´ë‹¹ ì½”ë“œì…ë‹ˆë‹¤. ---
    </script>
</body>
</html>
