<div id="result" class="result" style="display:none;"></div>

  <script>
    async function checkSubmission() {
      const name = document.getElementById("name").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const resultDiv = document.getElementById("result");

      if (!name || !phone) {
        resultDiv.style.display = "block";
        resultDiv.className = "result error";
        resultDiv.innerText = "이름과 연락처를 모두 입력해주세요.";
        return;
      }

      try {
        // 앱스 스크립트 URL은 본인의 정확한 URL로 유지해야 합니다.
        const response = await fetch(`https://script.google.com/macros/s/AKfycby-b3fiDuDlKgXbpqNG8g7aDnl3z5_aehA-QbmV2ot54CKZ9YcOYlQduO_BLokGJ0o/exec?name=${encodeURIComponent(name)}&phone=${encodeURIComponent(phone)}`);
        const data = await response.json();

        resultDiv.style.display = "block";

        if (data.error) {
          resultDiv.className = "result error";
          resultDiv.innerText = data.error;
        } else {
          resultDiv.className = "result";
          
          // 🌟 순번 정보를 추가하여 표시 🌟
          let rankMessage = '';
          if (data.rank) {
            rankMessage = `\n${data.major} 신청자 중 ${data.rank}번째`;
          }

          resultDiv.innerText =
            `✅ 신청 내역 확인\n\n` +
            `이름: ${data.name}\n` +
            `전공 선택: ${data.major}\n` +
            `동반 여부: ${data.companion}\n` +
            `신청 시간: ${data.timestamp}` +
            rankMessage; // 순번 메시지 추가
        }
      } catch (err) {
        resultDiv.style.display = "block";
        resultDiv.className = "result error";
        resultDiv.innerText = "요청 처리 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.";
      }
    }
  </script>
</body>
</html>
